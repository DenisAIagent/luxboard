var ce=Object.create;var I=Object.defineProperty,de=Object.defineProperties,me=Object.getOwnPropertyDescriptor,fe=Object.getOwnPropertyDescriptors,ge=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,he=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var mt=(e,t,o)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))X.call(t,o)&&mt(e,o,t[o]);if(F)for(var o of F(t))dt.call(t,o)&&mt(e,o,t[o]);return e},v=(e,t)=>de(e,fe(t)),ft=e=>I(e,"__esModule",{value:!0}),i=(e,t)=>I(e,"name",{value:t,configurable:!0});var gt=(e,t)=>{var o={};for(var r in e)X.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&F)for(var r of F(e))t.indexOf(r)<0&&dt.call(e,r)&&(o[r]=e[r]);return o};var be=(e,t)=>{for(var o in t)I(e,o,{get:t[o],enumerable:!0})},ht=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ge(t))!X.call(e,n)&&(o||n!=="default")&&I(e,n,{get:()=>t[n],enumerable:!(r=me(t,n))||r.enumerable});return e},a=(e,t)=>ht(ft(I(e!=null?ce(he(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),ve=(e=>(t,o)=>e&&e.get(t)||(o=ht(ft({}),t,1),e&&e.set(t,o),o))(typeof WeakMap!="undefined"?new WeakMap:0);var ye={};be(ye,{AlignmentButtons:()=>Z,ClearButtons:()=>nt,DefaultEditorOptions:()=>re,FormatButtons:()=>K,LevelSelect:()=>lt,LinkButtons:()=>ot,ListButtons:()=>Y,QuoteButtons:()=>it,RichTextInput:()=>Ce,RichTextInputToolbar:()=>ut,TiptapEditorContext:()=>O,TiptapEditorProvider:()=>J,useEditorSelection:()=>tt,useTiptapEditor:()=>h});var C=a(require("react")),pt=require("react"),Jt=a(require("clsx")),W=require("@tiptap/react"),Kt=a(require("@tiptap/starter-kit")),Yt=a(require("@tiptap/extension-underline")),Zt=a(require("@tiptap/extension-link")),te=a(require("@tiptap/extension-text-align")),ee=require("@mui/material"),oe=require("@mui/material/styles"),w=require("ra-core"),Q=require("ra-ui-materialui");var vt=a(require("react"));var bt=require("react"),O=(0,bt.createContext)(void 0);var J=i(({children:e,value:t})=>vt.createElement(O.Provider,{value:t},e),"TiptapEditorProvider");var L=a(require("react")),Qt=require("@mui/material/styles");var E=a(require("react")),N=require("react"),P=require("@mui/material"),Tt=a(require("@mui/icons-material/FormatBold")),Et=a(require("@mui/icons-material/FormatItalic")),Lt=a(require("@mui/icons-material/FormatUnderlined")),xt=a(require("@mui/icons-material/FormatStrikethrough")),Bt=a(require("@mui/icons-material/Code")),Rt=require("ra-core");var z=require("react");var h=i(()=>{let[e,t]=(0,z.useState)(!1),o=(0,z.useContext)(O);return(0,z.useEffect)(()=>{let r=i(()=>{t(!0)},"onReady");return o!=null&&(t(o.isEditable),o.on("create",r)),()=>{o!=null&&o.off("create",r)}},[o]),e?o:null},"useTiptapEditor");var K=i(e=>{let t=h(),o=(0,Rt.useTranslate)(),[r,n]=(0,N.useState)([]),m=o("ra.tiptap.bold",{_:"Bold"}),u=o("ra.tiptap.italic",{_:"Italic"}),b=o("ra.tiptap.underline",{_:"Underline"}),c=o("ra.tiptap.strike",{_:"Strikethrough"}),f=o("ra.tiptap.code",{_:"Code"});(0,N.useEffect)(()=>{let l=i(()=>{n(()=>Ct.reduce((p,s)=>(t&&t.isActive(s)&&p.push(s),p),[]))},"handleUpdate");return t&&(t.on("update",l),t.on("selectionUpdate",l)),()=>{t&&(t.off("update",l),t.off("selectionUpdate",l))}},[t]);let d=i((l,p)=>{Ct.forEach(s=>{let S=t&&t.isActive(s)&&!p.includes(s),A=t&&!t.isActive(s)&&p.includes(s);(S||A)&&Te[s](t)})},"handleChange");return E.createElement(P.ToggleButtonGroup,v(g({},e),{disabled:!(t==null?void 0:t.isEditable),onChange:d,value:r}),E.createElement(P.ToggleButton,{value:"bold","aria-label":m,title:m},E.createElement(Tt.default,{fontSize:"inherit"})),E.createElement(P.ToggleButton,{value:"italic","aria-label":u,title:u},E.createElement(Et.default,{fontSize:"inherit"})),E.createElement(P.ToggleButton,{value:"underline","aria-label":b,title:b},E.createElement(Lt.default,{fontSize:"inherit"})),E.createElement(P.ToggleButton,{value:"strike","aria-label":c,title:c},E.createElement(xt.default,{fontSize:"inherit"})),E.createElement(P.ToggleButton,{value:"code","aria-label":f,title:f},E.createElement(Bt.default,{fontSize:"inherit"})))},"FormatButtons"),Ct=["bold","italic","underline","strike","code"],Te={bold:e=>e.chain().focus().toggleBold().run(),italic:e=>e.chain().focus().toggleItalic().run(),underline:e=>e.chain().focus().toggleUnderline().run(),strike:e=>e.chain().focus().toggleStrike().run(),code:e=>e.chain().focus().toggleCode().run()};var M=a(require("react")),$=require("react"),U=require("@mui/material"),St=a(require("@mui/icons-material/FormatListBulleted")),Pt=a(require("@mui/icons-material/FormatListNumbered")),yt=require("ra-core");var Y=i(e=>{let t=h(),o=(0,yt.useTranslate)(),r=o("ra.tiptap.list_bulleted",{_:"Bulleted list"}),n=o("ra.tiptap.list_numbered",{_:"Numbered list"}),[m,u]=(0,$.useState)(),b=i((c,f)=>{kt.forEach(d=>{let l=t&&t.isActive(d)&&f!==d,p=t&&!t.isActive(d)&&f===d;(l||p)&&Ee[d](t)})},"handleChange");return(0,$.useEffect)(()=>{let c=i(()=>{u(()=>kt.reduce((f,d)=>t&&t.isActive(d)?d:f,void 0))},"handleUpdate");return t&&(t.on("update",c),t.on("selectionUpdate",c)),()=>{t&&(t.off("update",c),t.off("selectionUpdate",c))}},[t]),M.createElement(U.ToggleButtonGroup,v(g({},e),{disabled:!(t==null?void 0:t.isEditable),exclusive:!0,onChange:b,value:m}),M.createElement(U.ToggleButton,{value:"bulletList","aria-label":r,title:r},M.createElement(St.default,{fontSize:"inherit"})),M.createElement(U.ToggleButton,{value:"orderedList","aria-label":n,title:n},M.createElement(Pt.default,{fontSize:"inherit"})))},"ListButtons"),kt=["bulletList","orderedList"],Ee={bulletList:e=>e.chain().focus().toggleBulletList().run(),orderedList:e=>e.chain().focus().toggleOrderedList().run()};var B=a(require("react")),G=require("react"),k=require("@mui/material"),At=a(require("@mui/icons-material/FormatAlignCenter")),It=a(require("@mui/icons-material/FormatAlignLeft")),zt=a(require("@mui/icons-material/FormatAlignRight")),Mt=a(require("@mui/icons-material/FormatAlignJustify")),_t=require("ra-core");var Z=i(e=>{let t=h(),o=(0,_t.useTranslate)(),[r,n]=(0,G.useState)("left"),m=o("ra.tiptap.align_left",{_:"Align left"}),u=o("ra.tiptap.align_right",{_:"Align right"}),b=o("ra.tiptap.align_center",{_:"Center"}),c=o("ra.tiptap.align_justify",{_:"Justify"});(0,G.useEffect)(()=>{let d=i(()=>{n(l=>Le.reduce((p,s)=>t&&t.isActive({textAlign:s})?s:p,l))},"handleUpdate");return t&&(t.on("update",d),t.on("selectionUpdate",d)),()=>{t&&(t.off("update",d),t.off("selectionUpdate",d))}},[t]);let f=i((d,l)=>{Ot[l]&&Ot[l](t)},"handleChange");return B.createElement(k.ToggleButtonGroup,v(g({},e),{disabled:!(t==null?void 0:t.isEditable),exclusive:!0,onChange:f,value:r}),B.createElement(k.ToggleButton,{value:"left","aria-label":m,title:m},B.createElement(It.default,{fontSize:"inherit"})),B.createElement(k.ToggleButton,{value:"center","aria-label":b,title:b},B.createElement(At.default,{fontSize:"inherit"})),B.createElement(k.ToggleButton,{value:"right","aria-label":u,title:u},B.createElement(zt.default,{fontSize:"inherit"})),B.createElement(k.ToggleButton,{value:"justify","aria-label":c,title:c},B.createElement(Mt.default,{fontSize:"inherit"})))},"AlignmentButtons"),Le=["left","center","right","justify","code"],Ot={left:e=>e.chain().focus().setTextAlign("left").run(),center:e=>e.chain().focus().setTextAlign("center").run(),right:e=>e.chain().focus().setTextAlign("right").run(),justify:e=>e.chain().focus().setTextAlign("justify").run()};var et=a(require("react")),Ut=require("@mui/material"),Ht=a(require("@mui/icons-material/InsertLink")),Ft=require("ra-core");var D=require("react");var tt=i(()=>{let e=h(),[t,o]=(0,D.useState)(e?e.state.doc.textBetween(e.state.selection.from,e.state.selection.to):null);return(0,D.useEffect)(()=>{let r=i(()=>{o(e?e.state.doc.textBetween(e.state.selection.from,e.state.selection.to):null)},"handleSelectionChange");return e&&e.on("selectionUpdate",r),()=>{e&&e.off("selectionUpdate",r)}},[e]),t},"useEditorSelection");var ot=i(e=>{let t=h(),o=(0,Ft.useTranslate)(),r=tt(),n=o("ra.tiptap.link",{_:"Add a link"}),m=i(()=>{if(!t.can().setLink({href:""}))return;let u=window.prompt("URL");t.chain().focus().extendMarkRange("link").setLink({href:u}).run()},"handleClick");return et.createElement(Ut.ToggleButton,v(g({"aria-label":n,title:n},e),{disabled:!(t==null?void 0:t.isEditable)||!r,value:"link",onClick:m,selected:t&&t.isActive("link")}),et.createElement(Ht.default,{fontSize:"inherit"}))},"LinkButtons");var rt=a(require("react")),q=require("react"),Nt=require("@mui/material"),$t=a(require("@mui/icons-material/FormatQuote")),Gt=require("ra-core");var it=i(e=>{let t=h(),o=(0,Gt.useTranslate)(),[r,n]=(0,q.useState)(!1),m=o("ra.tiptap.blockquote",{_:"Blockquote"});return(0,q.useEffect)(()=>{let u=i(()=>{n(t&&t.isActive("blockquote"))},"handleUpdate");return t&&(t.on("update",u),t.on("selectionUpdate",u)),()=>{t&&(t.off("update",u),t.off("selectionUpdate",u))}},[t]),rt.createElement(Nt.ToggleButton,v(g({"aria-label":m,title:m},e),{disabled:!(t==null?void 0:t.isEditable),onClick:()=>t.chain().focus().toggleBlockquote().run(),selected:r,value:"quote"}),rt.createElement($t.default,{fontSize:"inherit"}))},"QuoteButtons");var at=a(require("react")),Dt=require("@mui/material"),qt=a(require("@mui/icons-material/FormatClear")),Vt=require("ra-core");var nt=i(e=>{let t=h(),r=(0,Vt.useTranslate)()("ra.tiptap.clear_format",{_:"Clear format"});return at.createElement(Dt.ToggleButton,v(g({"aria-label":r,title:r},e),{disabled:!(t==null?void 0:t.isEditable),value:"clear",onClick:()=>t.chain().focus().unsetAllMarks().run()}),at.createElement(qt.default,{fontSize:"inherit"}))},"ClearButtons");var y=a(require("react")),H=require("react"),R=require("@mui/material"),V=require("@mui/material/styles"),jt=a(require("@mui/icons-material/ArrowDropDown")),Wt=require("ra-core"),wt=a(require("clsx"));var lt=i(e=>{let t=(0,Wt.useTranslate)(),o=h(),[r,n]=(0,H.useState)(null),{size:m}=e,[u,b]=(0,H.useState)(j[0]),c=i((l,p)=>{n(null);let s=j[p];s.value==="paragraph"?o.chain().focus().setParagraph().run():s.value==="heading"&&o.chain().focus().setHeading({level:s.level}).run()},"handleMenuItemClick"),f=i(l=>{n(l.currentTarget)},"handleClickListItem"),d=i(l=>{n(null)},"handleClose");return(0,H.useEffect)(()=>{let l=i(()=>{b(p=>j.reduce((s,S)=>o&&(S.value==="paragraph"&&o.isActive("paragraph")||o.isActive("heading",{level:S.level}))?S:s,p))},"handleUpdate");return o&&(o.on("update",l),o.on("selectionUpdate",l)),()=>{o&&(o.off("update",l),o.off("selectionUpdate",l))}},[o]),y.createElement(xe,null,y.createElement(R.List,{component:"nav","aria-label":t("ra.tiptap.select_level",{_:"Select the level"}),dense:!0,disablePadding:!0,className:_.list},y.createElement(R.ListItem,{button:!0,"aria-haspopup":"true","aria-controls":"level-menu","aria-label":t("ra.tiptap.current_level",{_:"Current level"}),disabled:!(o==null?void 0:o.isEditable),onClick:f,className:(0,wt.default)({[_.sizeSmall]:m==="small",[_.sizeLarge]:m==="large"})},y.createElement(R.ListItemText,{primary:t(u.label,{_:u.defaultLabel})}),y.createElement(jt.default,null))),y.createElement(R.Menu,{anchorEl:r,open:Boolean(r),id:"level-menu",onClose:d},j.map((l,p)=>y.createElement(R.MenuItem,{key:l.label,selected:l===u,onClick:s=>{c(s,p)}},t(l.label,{_:l.defaultLabel})))))},"LevelSelect"),j=[{label:"ra.tiptap.paragraph",defaultLabel:"Normal",value:"paragraph"},{label:"ra.tiptap.heading1",defaultLabel:"Heading 1",value:"heading",level:1},{label:"ra.tiptap.heading2",defaultLabel:"Heading 2",value:"heading",level:2},{label:"ra.tiptap.heading3",defaultLabel:"Heading 3",value:"heading",level:3},{label:"ra.tiptap.heading4",defaultLabel:"Heading 4",value:"heading",level:4},{label:"ra.tiptap.heading5",defaultLabel:"Heading 5",value:"heading",level:5},{label:"ra.tiptap.heading6",defaultLabel:"Heading 6",value:"heading",level:6}],st="RaRichTextInputLevelSelect",_={list:`${st}-list`,sizeSmall:`${st}-sizeSmall`,sizeLarge:`${st}-sizeLarge`},xe=(0,V.styled)("div")(({theme:e})=>({[`&.${_.list}`]:{borderRadius:e.shape.borderRadius,border:`1px solid ${(0,V.alpha)(e.palette.action.active,.12)}`},[`& .${_.sizeSmall}`]:{paddingTop:1,paddingBottom:1,"& .MuiTypography-root":{fontSize:e.typography.pxToRem(13)}},[`& .${_.sizeLarge}`]:{paddingTop:8,paddingBottom:8,"& .MuiTypography-root":{fontSize:e.typography.pxToRem(15)}}}));var ut=i(e=>{let n=e,{size:t="medium",children:o=L.createElement(L.Fragment,null,L.createElement(lt,{size:t}),L.createElement(K,{size:t}),L.createElement(Z,{size:t}),L.createElement(Y,{size:t}),L.createElement(ot,{size:t}),L.createElement(it,{size:t}),L.createElement(nt,{size:t}))}=n,r=gt(n,["size","children"]);return L.createElement(Re,g({className:Xt.root},r),o)},"RichTextInputToolbar"),Be="RaRichTextInputToolbar",Xt={root:`${Be}-root`},Re=(0,Qt.styled)("div")(({theme:e})=>({[`&.${Xt.root}`]:{display:"flex",marginBottom:e.spacing(1),alignItems:"center","& > *":{marginRight:e.spacing(1)},"& > *:last-child":{marginRight:0}}}));var Ce=i(e=>{let{className:t,defaultValue:o="",disabled:r=!1,editorOptions:n=re,fullWidth:m,helperText:u,label:b,readOnly:c=!1,source:f,toolbar:d}=e,l=(0,w.useResourceContext)(e),{id:p,field:s,isRequired:S,fieldState:A,formState:{isSubmitted:ne}}=(0,w.useInput)(v(g({},e),{source:f,defaultValue:o})),x=(0,W.useEditor)(v(g({},n),{editable:!r&&!c,content:s.value,editorProps:{attributes:{id:p}}})),{error:le,invalid:se,isTouched:ue}=A;return(0,pt.useEffect)(()=>{!x||x.setOptions({editable:!r&&!c,editorProps:{attributes:{id:p}}})},[r,x,c,p]),(0,pt.useEffect)(()=>{if(!x)return;let ct=i(()=>{if(x.isEmpty){s.onChange(""),s.onBlur();return}let pe=x.getHTML();s.onChange(pe),s.onBlur()},"handleEditorUpdate");return x.on("update",ct),()=>{x.off("update",ct)}},[x,s]),C.createElement(Q.Labeled,{isRequired:S,label:b,id:`${p}-label`,color:(A==null?void 0:A.invalid)?"error":void 0,source:f,resource:l,fullWidth:m},C.createElement(Se,{className:(0,Jt.default)("ra-input",`ra-input-${f}`,t),editor:x,error:le,helperText:u,id:p,isTouched:ue,isSubmitted:ne,invalid:se,toolbar:d||C.createElement(ut,null)}))},"RichTextInput"),Se=i(({className:e,editor:t,error:o,fullWidth:r,helperText:n,id:m,isTouched:u,isSubmitted:b,invalid:c,toolbar:f})=>C.createElement(Pe,{className:e},C.createElement(J,{value:t},f,C.createElement(W.EditorContent,{"aria-labelledby":`${m}-label`,className:ae.editorContent,editor:t})),C.createElement(ee.FormHelperText,{className:(u||b)&&c?"ra-rich-text-input-error":"",error:(u||b)&&c},C.createElement(Q.InputHelperText,{touched:u||b,error:o==null?void 0:o.message,helperText:n}))),"RichTextInputContent"),re={extensions:[Kt.default,Yt.default,Zt.default,te.default.configure({types:["heading","paragraph"]})]},ie="RaRichTextInput",ae={editorContent:`${ie}-editorContent`},Pe=(0,oe.styled)("div",{name:ie,overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",[`& .${ae.editorContent}`]:{width:"100%","& .ProseMirror":{backgroundColor:e.palette.background.default,borderColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)",borderRadius:e.shape.borderRadius,borderStyle:"solid",borderWidth:"1px",padding:e.spacing(1),'&[contenteditable="false"], &[contenteditable="false"]:hover, &[contenteditable="false"]:focus':{backgroundColor:e.palette.action.disabledBackground},"&:hover":{backgroundColor:e.palette.action.hover},"&:focus":{backgroundColor:e.palette.background.default},"& p":{margin:"0 0 1em 0","&:last-child":{marginBottom:0}}}}}));module.exports=ve(ye);0&&(module.exports={AlignmentButtons,ClearButtons,DefaultEditorOptions,FormatButtons,LevelSelect,LinkButtons,ListButtons,QuoteButtons,RichTextInput,RichTextInputToolbar,TiptapEditorContext,TiptapEditorProvider,useEditorSelection,useTiptapEditor});
//# sourceMappingURL=index.js.map